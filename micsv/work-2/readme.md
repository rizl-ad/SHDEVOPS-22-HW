# Решение ДЗ к занятию «Микросервисы: принципы»

## Задача 1: API Gateway

Сравнительная таблица, в которой представлены ключевые характеристики наиболее популярных on-premises open-source API Gateway решений.

| **Характеристика**                                          | **Kong Gateway**                                                | **Tyk Gateway**                                                      | **KrakenD CE**                                                | **Apache APISIX**                                         | **Gravitee.io CE**                                                 | **WSO2 API Manager**                                            | **Envoy**                                                     | **Traefik**                                              | **NGINX**                                                 |
| ----------------------------------------------------------- | --------------------------------------------------------------- | -------------------------------------------------------------------- | ------------------------------------------------------------- | --------------------------------------------------------- | ------------------------------------------------------------------ | --------------------------------------------------------------- | ------------------------------------------------------------- | -------------------------------------------------------- | --------------------------------------------------------- |
| **Масштабируемость**                                        | Высокая, поддержка кластеризации и балансировки нагрузки        | Высокая, поддержка кластеров и масштабирования через мастер/слейв    | Очень высокая, поддержка агрегации множества API              | Очень высокая, поддержка кластеризации и масштабируемости | Высокая, поддержка кластеризации и распределенных систем           | Высокая, поддержка горизонтального масштабирования              | Очень высокая, интеграция с сервисной сеткой (Service Mesh)   | Высокая, интеграция с Docker/Kubernetes                  | Высокая, поддержка кластеризации и балансировки нагрузки  |
| **Производительность**                                      | Высокая, оптимизировано для высоконагруженных API               | Высокая, высокая производительность                                  | Очень высокая, оптимизировано для агрегации                   | Высокая, низкая латентность                               | Хорошая, но ограничена сложностью конфигурации                     | Хорошая, поддержка нагрузки и масштабируемости                  | Очень высокая, оптимизировано для работы с микросервисами     | Высокая, низкая латентность, быстрая маршрутизация       | Очень высокая, отличная производительность на уровне HTTP |
| **Отказоустойчивость**                                      | Высокая, поддержка фейловеров и кластеризации                   | Высокая, встроенная поддержка фейловеров                             | Высокая, поддержка балансировки нагрузки и отказоустойчивости | Высокая, поддержка фейловеров и репликации                | Средняя, зависит от настроек                                       | Очень высокая, поддержка отказоустойчивости и репликации        | Очень высокая, встроенные механизмы фейловеров и балансировки | Высокая, поддержка отказоустойчивости и репликации       | Высокая, поддержка фейловеров, репликации и кластеризации |
| **Маршрутизация**                                  		      | Очень гибкая маршрутизация по URI, HTTP методам, заголовкам     | Гибкая маршрутизация по URI, методам, заголовкам и другим параметрам | Ограниченная гибкость, фокус на агрегации                     | Очень гибкая маршрутизация с поддержкой сложных маршрутов | Средняя гибкость маршрутизации, поддержка кастомизации             | Очень гибкая маршрутизация с поддержкой сложных схем            | Очень гибкая маршрутизация с настройкой через фильтры         | Гибкая маршрутизация с поддержкой динамических маршрутов | Простая маршрутизация, поддержка стандартных маршрутов    |
| **Аутентификация** 					                                | Поддержка JWT, OAuth 2.0, API Keys, HMAC и других               | Поддержка JWT, OAuth 2.0, API Keys, HMAC, LDAP и других              | Поддержка JWT, OAuth 2.0 через плагины                        | Поддержка JWT, OAuth 2.0, Keycloak и других               | Поддержка JWT, OAuth 2.0, API Keys                                 | Поддержка OAuth 2.0, JWT, SSO, LDAP                             | Интеграция с внешними сервисами для аутентификации            | Интеграция с внешними системами для аутентификации       | Ограниченные возможности через модули                     |
| **Авторизация**                                             | Поддержка RBAC, ACL, плагинов                                   | Поддержка RBAC, ACL, плагинов                                        | Поддержка RBAC, ACL через плагины                             | Поддержка RBAC, ACL через плагины                         | Поддержка RBAC, ACL                                                | Расширенная авторизация через WSO2 Identity Server              | Интеграция с внешними системами для авторизации               | Интеграция с внешними сервисами для авторизации          | Ограниченные возможности через модули                     |
| **Мониторинг и логирование**                                | Интеграция с Prometheus, Grafana, ELK Stack                     | Встроенные средства аналитики, поддержка Prometheus, Grafana         | Интеграция с Prometheus                                       | Интеграция с Prometheus, Grafana, ELK                     | Встроенные возможности мониторинга, поддержка внешних инструментов | Встроенные средства мониторинга, поддержка внешних инструментов | Интеграция с Prometheus, Datadog и другими системами          | Интеграция с Prometheus и другими системами              | Интеграция с Prometheus, ELK и другими внешними системами |
| **Управление трафиком**                                     | Поддержка rate limiting, circuit breaking, retries, IP blocking | Поддержка rate limiting, retries, IP blocking, backpressure          | Поддержка rate limiting, retries, circuit breaking            | Поддержка rate limiting, retries, circuit breaking        | Поддержка rate limiting, retries, circuit breaking                 | Поддержка rate limiting, retries, circuit breaking              | Поддержка rate limiting, retries, circuit breaking            | Поддержка rate limiting, retries, circuit breaking       | Поддержка rate limiting, retries, circuit breaking        |
| **Кэширование**                                             | Встроенное кэширование запросов и ответов                       | Кэширование на уровне запросов и ответов                             | Поддержка кэширования ответов API                             | Встроенные возможности кэширования                        | Встроенные возможности кэширования                                 | Встроенное кэширование, возможности настройки                   | Встроенное кэширование через фильтры                          | Встроенные возможности кэширования                       | Встроенное кэширование на уровне HTTP                     |
| **Поддержка контейнеризации**                               | Да, поддержка Docker, Kubernetes                                | Да, поддержка Docker, Kubernetes                                     | Да, поддержка Docker, Kubernetes                              | Да, поддержка Docker, Kubernetes                          | Да, поддержка Docker, Kubernetes                                   | Да, поддержка Docker, Kubernetes                                | Да, интеграция с сервисной сеткой                             | Да, интеграция с Docker, Kubernetes                      | Да, поддержка Docker, Kubernetes                          |
| **Терминация HTTPS**                                        | Поддержка терминации HTTPS, настройка SSL                       | Поддержка терминации HTTPS, настройка сертификатов через UI          | Поддержка терминации HTTPS через конфигурацию                 | Поддержка терминации HTTPS через конфигурацию             | Поддержка терминации HTTPS                                         | Поддержка терминации HTTPS через конфигурацию                   | Поддержка терминации HTTPS и конфигурирования SSL/TLS         | Поддержка терминации HTTPS через Let's Encrypt           | Поддержка терминации HTTPS через конфигурационные файлы   |


### Рекомендации:
Kong Gateway и Tyk Gateway — лучшие выборы для крупных компаний, оба решения обеспечивают гибкую маршрутизацию, проверку аутентификационной информации (JWT, OAuth 2.0), терминацию HTTPS и масштабируемость. Эти решения также поддерживают расширение через плагины, что делает их отличными для сложных микросервисных архитектур.

**Tyk Gateway** является отличным выбором, и в некоторых случаях он может быть предпочтительнее **Kong Gateway**, в зависимости от специфики требований. Выбо сделан в пользу **Kong** по следующим причинам:

### 1. **Широкий функционал из коробки и экосистема**

* **Kong** предлагает более широкий набор функционала и более развитую экосистему с множеством плагинов и интеграций, как для **мониторинга**, так и для **безопасности** (например, интеграция с **OAuth 2.0**, **JWT**, **API Keys**, и многое другое). Это дает больше гибкости и возможностей для кастомизации.

* **Tyk** тоже поддерживает эти функции, но в **Kong** можно найти более зрелое и проверенное решение с широким набором плагинов, особенно когда речь идет о **мониторинге**, **логировании** и **интеграциях** с такими популярными инструментами, как **Prometheus** и **Grafana**.

### 2. **Масштабируемость и производительность**

* **Kong** имеет высокую производительность и эффективную архитектуру для **горизонтального масштабирования**. Он использует распределённую базу данных (например, **Cassandra** или **PostgreSQL**) для хранения данных, что позволяет ему масштабироваться в больших системах.

* **Tyk** также поддерживает масштабируемость, но архитектура в **Kong** была специально оптимизирована для работы в крупных распределённых системах, где важна высокая доступность и отказоустойчивость при масштабировании.

### 3. **Решения для микросервисов и сервисных сеток**

* **Kong** активно интегрируется с сервисными сетями и **Service Mesh** (например, **Istio**, **Consul**), что делает его отличным выбором для сложных микросервисных архитектур с потребностью в гибкой маршрутизации и управлении трафиком.
* **Tyk** тоже поддерживает интеграции с такими сервисами, но по функционалу **Kong** в этом контексте более зрелый и предлагает больше возможностей для интеграции с **Service Mesh**.

### 4. **Поддержка контейнеризации и Kubernetes**

* **Kong** имеет активную интеграцию с **Kubernetes** и **Docker**, что делает его отличным выбором для микросервисов в контейнеризованных средах. В отличии от **Tyk**, **Kong** может предложить более удобные и гибкие механизмы развертывания в таких средах.

### 5. **Сообщество и коммерческая поддержка**

* **Kong** имеет более крупное и активное сообщество, а также предлагает разнообразные коммерческие версии с расширенным функционалом и поддержкой. Это может быть полезно, если вам нужно больше возможностей или гарантии поддержки на уровне предприятия.
* **Tyk** тоже имеет активное сообщество и предлагает как бесплатные, так и платные версии. Однако, если для компании важна активная поддержка и множество плагинов, **Kong** может предложить больше вариантов.

### 6. **Цены и лицензирование**

* **Tyk** имеет более простую и гибкую лицензию, и в некоторых случаях это может быть выгодно для компаний с ограниченным бюджетом. Он предоставляет бесплатную и коммерческую версии, и стоимость лицензии на платные функции (например, управление API) может быть ниже, чем у **Kong**.
* **Kong** может быть дороже в плане коммерческих лицензий, но в этом случае вы получаете более широкий функционал и более зрелое решение для масштабных инфраструктур.

### 7. **Модульность**

* **Kong** поддерживает много сторонних плагинов и расширений, что делает его более гибким и настраиваемым для различных нужд. Например, можно использовать плагины для **медленного старта**, **профилирования** и **оптимизации запросов**.

* В **Tyk** тоже есть плагины, но их экосистема не так масштабна, и для некоторых специализированных случаев может не хватить гибкости.

### Заключение:

Если компания разрабатывает **крупную распределённую систему** с высоким уровнем сложности, с требованиями к **масштабируемости**, **гибкости маршрутизации**, интеграции с **Service Mesh** и **обширным мониторингом**, то **Kong** будет лучшим выбором. **Kong** предоставляет больше возможностей, инструментов и гибкости, что делает его предпочтительным для более сложных архитектур.

## Задача 2: Брокер сообщений
